<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Spectra: Spectra::DavidsonSymEigsSolver&lt; OpType &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Spectra
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Header-only C++ Library for Large Scale Eigenvalue Problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classSpectra_1_1DavidsonSymEigsSolver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classSpectra_1_1DavidsonSymEigsSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Spectra::DavidsonSymEigsSolver&lt; OpType &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__EigenSolver.html">Eigen Solvers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="DavidsonSymEigsSolver_8h_source.html">Spectra/DavidsonSymEigsSolver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Spectra::DavidsonSymEigsSolver&lt; OpType &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classSpectra_1_1DavidsonSymEigsSolver.png" usemap="#Spectra::DavidsonSymEigsSolver_3C_20OpType_20_3E_map" alt=""/>
  <map id="Spectra::DavidsonSymEigsSolver_3C_20OpType_20_3E_map" name="Spectra::DavidsonSymEigsSolver_3C_20OpType_20_3E_map">
<area href="classSpectra_1_1JDSymEigsBase.html" alt="Spectra::JDSymEigsBase&lt; DavidsonSymEigsSolver&lt; OpType &gt;, OpType &gt;" shape="rect" coords="0,0,439,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab0b47a59927a22b492fe0a1b300322df"><td class="memItemLeft" align="right" valign="top"><a id="ab0b47a59927a22b492fe0a1b300322df"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DavidsonSymEigsSolver</b> (OpType &amp;op, Index nev)</td></tr>
<tr class="separator:ab0b47a59927a22b492fe0a1b300322df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a622bf58f5bea536a794ef53c6406cbaa"><td class="memItemLeft" align="right" valign="top">Matrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1DavidsonSymEigsSolver.html#a622bf58f5bea536a794ef53c6406cbaa">setup_initial_search_space</a> (<a class="el" href="group__Enumerations.html#ga699aae652eac3e9c714957fce4b395fd">SortRule</a> selection) const</td></tr>
<tr class="separator:a622bf58f5bea536a794ef53c6406cbaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b9455f2f5bcde0f7e1159eb9857c942"><td class="memItemLeft" align="right" valign="top">Matrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1DavidsonSymEigsSolver.html#a1b9455f2f5bcde0f7e1159eb9857c942">calculate_correction_vector</a> () const</td></tr>
<tr class="separator:a1b9455f2f5bcde0f7e1159eb9857c942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSpectra_1_1JDSymEigsBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSpectra_1_1JDSymEigsBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSpectra_1_1JDSymEigsBase.html">Spectra::JDSymEigsBase&lt; DavidsonSymEigsSolver&lt; OpType &gt;, OpType &gt;</a></td></tr>
<tr class="memitem:a1b1701964f36165abca0f1570a806eae inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a id="a1b1701964f36165abca0f1570a806eae"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>JDSymEigsBase</b> (OpType &amp;op, Index nev)</td></tr>
<tr class="separator:a1b1701964f36165abca0f1570a806eae inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69d245907f7d68fcec053ce9a95ca86 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#af69d245907f7d68fcec053ce9a95ca86">set_max_search_space_size</a> (Index max_search_space_size)</td></tr>
<tr class="separator:af69d245907f7d68fcec053ce9a95ca86 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a907f30b1026ecab0e7c77bed9e5f710a inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#a907f30b1026ecab0e7c77bed9e5f710a">set_correction_size</a> (Index correction_size)</td></tr>
<tr class="separator:a907f30b1026ecab0e7c77bed9e5f710a inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbc66f28bd1d0c75ce5926c2deee598 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#acbbc66f28bd1d0c75ce5926c2deee598">set_initial_search_space_size</a> (Index initial_search_space_size)</td></tr>
<tr class="separator:acbbc66f28bd1d0c75ce5926c2deee598 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c3bd14b22c276f6747960073768c70 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#ac6c3bd14b22c276f6747960073768c70">~JDSymEigsBase</a> ()</td></tr>
<tr class="separator:ac6c3bd14b22c276f6747960073768c70 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d777263795aff0c6e4d6ac9f8b86a8 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Enumerations.html#gae1a6cf904d752db2f5641ec79a1bbbf0">CompInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#a09d777263795aff0c6e4d6ac9f8b86a8">info</a> () const</td></tr>
<tr class="separator:a09d777263795aff0c6e4d6ac9f8b86a8 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ebc8d84a509a4394098877ca0690a0 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top">Index&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSpectra_1_1JDSymEigsBase.html#a97ebc8d84a509a4394098877ca0690a0">num_iterations</a> () const</td></tr>
<tr class="separator:a97ebc8d84a509a4394098877ca0690a0 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9324ef43a74ef02baef9112cd9ae90 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a id="a7a9324ef43a74ef02baef9112cd9ae90"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>eigenvalues</b> () const</td></tr>
<tr class="separator:a7a9324ef43a74ef02baef9112cd9ae90 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f448e4a2df64ea7873ead067bc5b867 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a id="a9f448e4a2df64ea7873ead067bc5b867"></a>
Matrix&#160;</td><td class="memItemRight" valign="bottom"><b>eigenvectors</b> () const</td></tr>
<tr class="separator:a9f448e4a2df64ea7873ead067bc5b867 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4614f2e877978448e0746e8abc1c6420 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a id="a4614f2e877978448e0746e8abc1c6420"></a>
Index&#160;</td><td class="memItemRight" valign="bottom"><b>compute</b> (<a class="el" href="group__Enumerations.html#ga699aae652eac3e9c714957fce4b395fd">SortRule</a> selection=SortRule::LargestMagn, Index maxit=100, Scalar tol=100 *Eigen::NumTraits&lt; Scalar &gt;::dummy_precision())</td></tr>
<tr class="separator:a4614f2e877978448e0746e8abc1c6420 inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74863e5c0766f094702cc4323cf71d4f inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memItemLeft" align="right" valign="top"><a id="a74863e5c0766f094702cc4323cf71d4f"></a>
Index&#160;</td><td class="memItemRight" valign="bottom"><b>compute_with_guess</b> (const Eigen::Ref&lt; const Matrix &gt; &amp;initial_space, <a class="el" href="group__Enumerations.html#ga699aae652eac3e9c714957fce4b395fd">SortRule</a> selection=SortRule::LargestMagn, Index maxit=100, Scalar tol=100 *Eigen::NumTraits&lt; Scalar &gt;::dummy_precision())</td></tr>
<tr class="separator:a74863e5c0766f094702cc4323cf71d4f inherit pub_methods_classSpectra_1_1JDSymEigsBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename OpType&gt;<br />
class Spectra::DavidsonSymEigsSolver&lt; OpType &gt;</h3>

<p>This class implement the DPR correction for the Davidson algorithms. The algorithms in the Davidson family only differ in how the correction vectors are computed and optionally in the initial orthogonal basis set.</p>
<p>the DPR correction compute the new correction vector using the following expression: </p><p class="formulaDsp">
\[ correction = -(\boldsymbol{D} - \rho \boldsymbol{I})^{-1} \boldsymbol{r} \]
</p>
<p> where \(D\) is the diagonal of the target matrix, \(\rho\) the Ritz eigenvalue, \(I\) the identity matrix and \(r\) the residue vector. </p>

<p class="definition">Definition at line <a class="el" href="DavidsonSymEigsSolver_8h_source.html#l00031">31</a> of file <a class="el" href="DavidsonSymEigsSolver_8h_source.html">DavidsonSymEigsSolver.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a622bf58f5bea536a794ef53c6406cbaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a622bf58f5bea536a794ef53c6406cbaa">&#9670;&nbsp;</a></span>setup_initial_search_space()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename OpType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Matrix <a class="el" href="classSpectra_1_1DavidsonSymEigsSolver.html">Spectra::DavidsonSymEigsSolver</a>&lt; OpType &gt;::setup_initial_search_space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Enumerations.html#ga699aae652eac3e9c714957fce4b395fd">SortRule</a>&#160;</td>
          <td class="paramname"><em>selection</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create initial search space based on the diagonal and the spectrum'target (highest or lowest)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selection</td><td>Spectrum section to target (e.g. lowest, etc.) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Matrix with the initial orthonormal basis </dd></dl>

<p class="definition">Definition at line <a class="el" href="DavidsonSymEigsSolver_8h_source.html#l00057">57</a> of file <a class="el" href="DavidsonSymEigsSolver_8h_source.html">DavidsonSymEigsSolver.h</a>.</p>

</div>
</div>
<a id="a1b9455f2f5bcde0f7e1159eb9857c942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b9455f2f5bcde0f7e1159eb9857c942">&#9670;&nbsp;</a></span>calculate_correction_vector()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename OpType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Matrix <a class="el" href="classSpectra_1_1DavidsonSymEigsSolver.html">Spectra::DavidsonSymEigsSolver</a>&lt; OpType &gt;::calculate_correction_vector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the corrections using the DPR method.</p>
<dl class="section return"><dt>Returns</dt><dd>New correction vectors. </dd></dl>

<p class="definition">Definition at line <a class="el" href="DavidsonSymEigsSolver_8h_source.html#l00074">74</a> of file <a class="el" href="DavidsonSymEigsSolver_8h_source.html">DavidsonSymEigsSolver.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Spectra/<a class="el" href="DavidsonSymEigsSolver_8h_source.html">DavidsonSymEigsSolver.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Spectra</b></li><li class="navelem"><a class="el" href="classSpectra_1_1DavidsonSymEigsSolver.html">DavidsonSymEigsSolver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0 </li>
  </ul>
</div>
</body>
</html>
